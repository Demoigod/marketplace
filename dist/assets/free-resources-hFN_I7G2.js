import{i as v,s as d,g as f,b as h}from"./auth-DlafXHy2.js";/* empty css              */let u=[],l="all";document.addEventListener("DOMContentLoaded",async()=>{if(!await v()){window.location.href="index.html";return}x(),await w(),L(),d.auth.onAuthStateChange(t=>{t==="SIGNED_OUT"&&(window.location.href="index.html")})});async function x(){const e=await f();e&&(document.querySelectorAll(".admin-name").forEach(o=>o.textContent=e.name||"User"),document.querySelectorAll(".avatar").forEach(o=>{o.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(e.name||"User")}&background=368CBF&color=fff`}))}async function w(){const e=document.getElementById("resourcesGrid");if(e)try{const{data:t,error:n}=await d.from("free_resources").select("*").order("created_at",{ascending:!1});if(n)throw n;u=t||[],p()}catch(t){console.error("Error fetching resources:",t.message),e.innerHTML='<div style="padding: 40px; text-align: center; color: #991B1B; grid-column: 1/-1;">Failed to load resources. Please try again later.</div>'}}function p(){const e=document.getElementById("resourcesGrid");if(!e)return;const t=u.filter(n=>l==="all"?!0:n.type===l);if(t.length===0){e.innerHTML='<div style="padding: 60px; text-align: center; color: #6b7280; grid-column: 1/-1;"><p style="font-size: 1.1rem;">No resources found in this category.</p></div>';return}e.innerHTML=t.map(n=>y(n)).join("")}function y(e){const t={notes:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>',slides:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>',exam:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"></path><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg>',info:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>'};return`
        <div class="resource-card">
            <div style="display: flex; gap: 16px; align-items: flex-start;">
                <div class="resource-icon-wrapper">
                    ${{notes:t.notes,slides:t.slides,exam:t.exam,info:t.info}[e.type]||t.notes}
                </div>
                <div style="flex: 1;">
                    <span class="resource-badge badge-${e.type||"notes"}">${e.type||"Resource"}</span>
                    <h3 style="font-size: 1.1rem; font-weight: 600; margin-top: 4px; color: #111827;">${e.title}</h3>
                    <p style="font-size: 0.9rem; color: #6b7280; margin-top: 2px;">${e.course||"General"}</p>
                </div>
            </div>
            <div class="resource-meta">
                <span>File: ${e.file_type||"PDF"}</span>
                <span>${new Date(e.created_at).toLocaleDateString()}</span>
            </div>
            <button class="download-btn" data-id="${e.id}" data-url="${e.file_url}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                Download
            </button>
        </div>
    `}function L(){const e=document.querySelectorAll(".resource-tab");e.forEach(i=>{i.addEventListener("click",()=>{e.forEach(r=>r.classList.remove("active")),i.classList.add("active"),l=i.dataset.category,p()})});const t=document.getElementById("resourceSearch");t&&t.addEventListener("input",E(i=>{const r=i.target.value.toLowerCase(),c=document.getElementById("resourcesGrid"),s=u.filter(a=>{const m=a.title.toLowerCase().includes(r)||a.course.toLowerCase().includes(r),g=l==="all"||a.type===l;return m&&g});s.length===0?c.innerHTML='<div style="padding: 60px; text-align: center; color: #6b7280; grid-column: 1/-1;">No matching resources found.</div>':c.innerHTML=s.map(a=>y(a)).join("")},300));const n=document.getElementById("resourcesGrid");n&&n.addEventListener("click",async i=>{const r=i.target.closest(".download-btn");if(!r)return;const c=r.dataset.id,s=r.dataset.url;s?(window.open(s,"_blank"),await d.from("resource_downloads").insert([{resource_id:c,user_id:(await f()).id}])):alert("This resource file is currently unavailable.")});const o=document.querySelector(".logout-btn");o&&o.addEventListener("click",async()=>{confirm("Are you sure you want to logout?")&&(await h(),window.location.href="index.html")})}function E(e,t){let n;return function(...o){clearTimeout(n),n=setTimeout(()=>e.apply(this,o),t)}}
